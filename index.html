<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>MIT Access Points & Buildings</title>

  <!-- Leaflet CSS -->
  <link
    rel="stylesheet"
    href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
    integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY="
    crossorigin=""
  />

  <style>
    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
      font-family: system-ui, -apple-system, BlinkMacSystemFont, sans-serif;
    }

    body {
      background: #f5f5f7;
      color: #111827;
      display: flex;
      height: 100vh;
      max-height: 100vh;
      overflow: hidden;
    }

    .sidebar {
      width: 340px;
      padding: 14px;
      background: #ffffff;
      border-right: 1px solid #e5e7eb;
      display: flex;
      flex-direction: column;
      gap: 8px;
    }

    .sidebar h1 {
      font-size: 18px;
      font-weight: 600;
    }

    .sidebar p.subtitle {
      font-size: 11px;
      color: #6b7280;
      margin-bottom: 6px;
    }

    .locations-list {
      display: flex;
      flex-direction: column;
      gap: 5px;
      overflow-y: auto;
      padding-right: 4px;
    }

    .loc-btn {
      padding: 7px 9px;
      border-radius: 9px;
      border: 1px solid #e5e7eb;
      background: #f9fafb;
      font-size: 11px;
      text-align: left;
      cursor: pointer;
      transition: all 0.15s ease;
    }

    .loc-btn strong {
      display: block;
      font-size: 11px;
      margin-bottom: 1px;
    }

    .loc-btn span {
      font-size: 10px;
      color: #6b7280;
    }

    .loc-btn:hover {
      background: #eef2ff;
      border-color: #4f46e5;
      transform: translateY(-1px);
      box-shadow: 0 4px 10px rgba(15,23,42,0.08);
    }

    .loc-btn.active {
      background: #4f46e5;
      color: #ffffff;
      border-color: #4338ca;
      box-shadow: 0 4px 12px rgba(79,70,229,0.35);
    }

    #map {
      flex: 1;
      position: relative;
    }

    #map-inner {
      height: 100%;
      width: 100%;
    }

    .info-panel {
      position: fixed;
      bottom: 14px;
      left: 360px; /* to the right of sidebar */
      max-width: 340px;
      padding: 9px 11px;
      background: rgba(17,24,39,0.96);
      color: #f9fafb;
      border-radius: 14px;
      font-size: 10px;
      box-shadow: 0 10px 26px rgba(15,23,42,0.4);
      backdrop-filter: blur(8px);
      z-index: 9999;
    }

    .info-panel h2 {
      font-size: 12px;
      margin-bottom: 2px;
      font-weight: 600;
    }

    .info-panel p {
      font-size: 10px;
      line-height: 1.5;
      color: #d1d5db;
      margin-bottom: 4px;
    }

    .info-panel ul {
      margin: 2px 0 6px;
      padding-left: 14px;
      font-size: 9px;
      color: #e5e7eb;
    }

    .info-btn {
      padding: 5px 8px;
      border-radius: 999px;
      border: none;
      font-size: 10px;
      cursor: pointer;
      background: #4f46e5;
      color: #f9fafb;
      box-shadow: 0 4px 10px rgba(79,70,229,0.5);
      transition: background 0.15s ease, transform 0.15s ease, box-shadow 0.15s ease;
    }

    .info-btn:hover {
      background: #4338ca;
      transform: translateY(-1px);
      box-shadow: 0 6px 14px rgba(79,70,229,0.6);
    }

    @media (max-width: 900px) {
      body {
        flex-direction: column;
      }
      .sidebar {
        width: 100%;
        border-right: none;
        border-bottom: 1px solid #e5e7eb;
        max-height: 40vh;
      }
      #map {
        height: 60vh;
      }
      .info-panel {
        left: 10px;
        bottom: 10px;
        max-width: 85%;
      }
    }
  </style>
</head>
<body>
  <div class="sidebar">
    <h1>MIT Access Points</h1>
    <p class="subtitle">
      Click an access point to highlight the main campus buildings it serves and open its info Classroom.
    </p>
    <div class="locations-list" id="accessPointsList"></div>
  </div>

  <div id="map">
    <div id="map-inner"></div>
  </div>

  <div class="info-panel" id="infoPanel">
    <h2>Welcome</h2>
    <p>Select an access point on the left or on the map to see which buildings are best accessed from there.</p>
  </div>

  <!-- Leaflet JS -->
  <script
    src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"
    integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo="
    crossorigin=""
  ></script>

  <script>
    // Base map centered on MIT
    const map = L.map("map-inner").setView([42.3592, -71.0930], 16);

    L.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png", {
      maxZoom: 19,
      attribution: "&copy; OpenStreetMap contributors"
    }).addTo(map);

    const infoPanel = document.getElementById("infoPanel");
    const accessPointsList = document.getElementById("accessPointsList");

    const accessPointMarkers = {};
    const accessPointButtons = {};
    const buildingMarkers = {};

    // --- BUILDINGS ---
    // Core main-campus buildings (1â€“10, 13, 14, 16, 18, 24, 26, 32, 34, 36 + key anchors).
    // Coordinates are approximate; refine from whereis.mit.edu if needed.
    const buildings = [
      { id: "b1",  name: "Building 1",  lat: 42.35808298091113, lng: -71.09252892002844 },
      { id: "b2",  name: "Building 2",  lat: 42.35881260020042, lng: -71.09001359573712 },
      { id: "b3",  name: "Building 3",  lat: 42.358892427102724, lng: -71.09239643390524 },
      { id: "b4",  name: "Building 4",  lat: 42.359261019159995, lng: -71.09089250044453 },
      { id: "b5",  name: "Building 5",  lat: 42.358713150474316, lng: -71.0929166109595 },
      { id: "b6",  name: "Building 6",  lat: 42.359482650557084, lng: -71.09038580764431 },
      { id: "b7",  name: "Building 7 (77 Mass Ave)", lat: 42.359188040364025, lng: -71.09320199302452 },
      { id: "b8",  name: "Building 8",  lat: 42.35996741797371, lng: -71.09080788984357 },
      { id: "b9",  name: "Building 9",  lat: 42.35974671250857, lng: -71.09354806544724 },
      { id: "b10", name: "Building 10 (Great Dome)", lat: 42.35975118837034, lng: -71.09205967873137 },
      { id: "b11", name: "Building 11", lat: 42.35953443404332, lng: -71.09277291630289 },
      { id: "b12", name: "Building 12", lat: 42.360220639697246, lng: -71.09152220256173 },
      { id: "b13", name: "Building 13", lat: 42.35993080323233, lng: -71.0925783863674 },
      { id: "b14", name: "Building 14", lat: 42.359099099073475, lng: -71.08909729454072 },
      { id: "b16", name: "Building 16", lat: 42.360476054657354, lng: -71.09047832335692 },
      { id: "b17", name: "Building 17", lat: 42.36024629992317, lng: -71.09360722409329 },
      { id: "b18", name: "Building 18", lat: 42.36005710377917, lng: -71.08977828240525 },
      { id: "b24", name: "Building 24", lat: 42.36065499950997, lng: -71.09205149770779 },
      { id: "b26", name: "Building 26", lat: 42.361096213716614, lng: -71.09133167466032 },
      { id: "b31", name: "Building 31", lat: 42.36038854896677, lng: -71.09306806843281 },
      { id: "b32", name: "Building 32 (Stata Center)", lat: 42.361706803467946, lng: -71.09072855813352 },
      { id: "b33", name: "Building 33", lat: 42.36016031663528, lng: -71.09380409002638 },
      { id: "b34", name: "Building 34", lat: 42.36114528392162, lng: -71.09193861322063 },
      { id: "b35", name: "Building 35", lat: 42.360387162916005, lng: -71.09402980055098 },
      { id: "b36", name: "Building 36", lat: 42.361461160557774, lng: -71.09164785044138 },
      { id: "b37", name: "Building 37", lat: 42.36069532346989, lng: -71.09323908453692 },
      { id: "b38", name: "Building 38", lat: 42.36107347348108, lng: -71.09235976739953 },
      { id: "b39", name: "Building 39", lat: 42.36086512557845, lng: -71.09273958554424 },
      { id: "b50", name: "Building 50", lat: 42.35938931883948, lng: -71.08829106761934 },
      { id: "b54", name: "Building 54", lat: 42.36032337695083, lng: -71.08933163155037 },
      { id: "b56", name: "Building 56", lat: 42.360695309605134, lng: -71.0898469462037 },
      { id: "b57", name: "Building 57", lat: 42.361147890837934, lng: -71.09007209921224 },
      { id: "b62", name: "Building 62", lat: 42.36021731653613, lng: -71.08866589807123 },
      { id: "b64", name: "Building 64", lat: 42.36042767448183, lng: -71.08816952917566 },
      { id: "b66", name: "Building 66", lat: 42.36093292249386, lng: -71.08902833905248 },
      { id: "b68", name: "Building 68", lat: 42.361668684806006, lng: -71.08861623388133 },
      { id: "b76", name: "Building 76", lat: 42.362280705070106, lng: -71.08931741962527 },
      { id: "w20", name: "W20 Stratton Student Center", lat: 42.359054791144004, lng: -71.09478624304269 },
      { id: "w16", name: "W16 Kresge Auditorium", lat: 42.358162864652655, lng: -71.09505825631894 },
      { id: "w35", name: "W35 Z Center", lat: 42.35870425126371, lng: -71.09589240096959 }
    ];

    // Draw subtle building markers
    buildings.forEach((b) => {
      const marker = L.circleMarker([b.lat, b.lng], {
        radius: 10,
        color: "#9ca3af",
        fillColor: "#9ca3af",
        fillOpacity: 0.85
      }).addTo(map);

      marker.bindTooltip(b.name, { permanent: false, direction: "top" });
      buildingMarkers[b.id] = marker;
    });

    // --- ACCESS POINTS ---
    // Each has its own Classroom link + list of building IDs it serves.
    const accessPoints = [
      {
        id: "alleyA",
        name: "Alley A",
        short: "Access between main campus and NE corridor.",
        lat: 42.360602986277335,
        lng: -71.09361991892301,
        classroomUrl: "https://classroom.google.com/c/ODEyNDUyODI0MDM0/a/ODE1NzgxMTQyMTYw/details",
        buildingsServed: ["b1", "b3", "b5", "b7", "b9", "b10", "b11", "b12", "b13", "b17", "b24", "b26", "b31", "b33", "b34", "b35", "b37"]
      },
      {
        id: "stataAlley",
        name: "Stata Access Alley",
        short: "Primary access to Stata / north complex.",
        lat: 42.36162669453648,
        lng: -71.09152363364225,
        classroomUrl: "https://classroom.google.com/c/ODEyNDUyODI0MDM0/m/ODE1Nzc5NjI4MTc4/details",
        buildingsServed: ["b26", "b32", "b36"]
      },
      {
        id: "hockfieldCourt",
        name: "Hockfield Court",
        short: "Central access between Koch, Stata, and main complex.",
        lat: 42.36108525150766,
        lng: -71.0884199733499,
        classroomUrl: "https://classroom.google.com/c/ODEyNDUyODI0MDM0/m/ODIzOTMwOTk0MTEz/details",
        buildingsServed: ["b16", "b56", "b57", "b66", "b68"]
      },
      {
        id: "mcdermottCourt",
        name: "McDermott Court",
        short: "Access for central dome & main corridor.",
        lat: 42.36090391955387,
        lng: -71.08830874699721,
        classroomUrl: "https://classroom.google.com/c/ODEyNDUyODI0MDM0/a/ODE1NzgxMTQxNDA4/details",
        buildingsServed: ["b2", "b6", "b8", "b14", "b16", "b18", "b50", "b56", "b62", "b64", "b66"]
      },
      {
        id: "killianCourt",
        name: "Killian Court",
        short: "Access for river-facing main buildings.",
        lat: 42.3579997334124,
        lng: -71.09100412745822,
        classroomUrl: "https://classroom.google.com/c/ODEyNDUyODI0MDM0/a/ODIzOTMwMjYwMTQ2/details",
        buildingsServed: ["b1", "b2", "b3", "b4", "b5", "b6"]
      },
      {
        id: "zCenter",
        name: "Z Center",
        short: "Access for athletics & west-side buildings.",
        lat: 42.35892562670535,
        lng: -71.09714086462036,
        classroomUrl: "https://classroom.google.com/c/ODEyNDUyODI0MDM0/a/ODIzOTMzMTg2NzQ1/details",
        buildingsServed: ["w16", "w20", "w35"]
      }
    ];

    // Create access point markers & sidebar buttons
    accessPoints.forEach((ap) => {
      const marker = L.marker([ap.lat, ap.lng]).addTo(map);
      marker.on("click", () => focusAccessPoint(ap.id));
      accessPointMarkers[ap.id] = marker;

      const btn = document.createElement("button");
      btn.className = "loc-btn";
      btn.innerHTML = `
        <strong>${ap.name}</strong>
        <span>${ap.short}</span>
      `;
      btn.addEventListener("click", () => focusAccessPoint(ap.id));
      accessPointsList.appendChild(btn);
      accessPointButtons[ap.id] = btn;
    });

    function resetBuildingHighlights() {
      Object.values(buildingMarkers).forEach((m) => {
        m.setStyle({
          radius: 5,
          color: "#9ca3af",
          fillColor: "#9ca3af",
          fillOpacity: 0.85
        });
      });
    }

    function highlightBuildings(ids) {
      ids.forEach((id) => {
        const marker = buildingMarkers[id];
        if (marker) {
          marker.setStyle({
            radius: 8,
            color: "#4f46e5",
            fillColor: "#4f46e5",
            fillOpacity: 1
          });
        }
      });
    }

    function focusAccessPoint(id) {
      const ap = accessPoints.find((a) => a.id === id);
      if (!ap) return;

      // Sidebar highlight
      Object.values(accessPointButtons).forEach((b) =>
        b.classList.remove("active")
      );
      if (accessPointButtons[id]) {
        accessPointButtons[id].classList.add("active");
      }

      // Reset + highlight buildings
      resetBuildingHighlights();
      highlightBuildings(ap.buildingsServed);

      // Fit map around access point + served buildings
      const pts = [[ap.lat, ap.lng]];
      ap.buildingsServed.forEach((bid) => {
        const b = buildings.find((bb) => bb.id === bid);
        if (b) pts.push([b.lat, b.lng]);
      });

      if (pts.length > 1) {
        const bounds = L.latLngBounds(pts).pad(0.2);
        map.fitBounds(bounds, { animate: true });
      } else {
        map.flyTo([ap.lat, ap.lng], 17, { animate: true });
      }

      // Resolve building names
      const servedNames = ap.buildingsServed
        .map((bid) => {
          const b = buildings.find((bb) => bb.id === bid);
          return b ? b.name : null;
        })
        .filter(Boolean);

      // Update info panel
      infoPanel.innerHTML = `
        <h2>${ap.name}</h2>
        <p>${ap.short}</p>
        ${
          servedNames.length
            ? `<p><strong>Buildings best accessed via this point:</strong></p>
               <ul>${servedNames.map((n) => `<li>${n}</li>`).join("")}</ul>`
            : `<p>No buildings configured yet for this access point.</p>`
        }
        <button class="info-btn" id="open-classroom">
          Open Google Classroom
        </button>
      `;

      const openBtn = document.getElementById("open-classroom");
      if (openBtn && ap.classroomUrl) {
        openBtn.addEventListener("click", () => {
          window.open(ap.classroomUrl, "_blank", "noopener");
        });
      }

      // Popup on marker
      accessPointMarkers[id]
        .bindPopup(`<b>${ap.name}</b><br>${ap.short}`)
        .openPopup();
    }
  </script>
</body>
</html>
